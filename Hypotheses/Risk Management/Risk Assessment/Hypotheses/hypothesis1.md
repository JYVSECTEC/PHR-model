### Hypothesis example 1: Ransomware overtaking company

Company called Acme has an AD environment with about 700 workstations connected to it. These Windows workstations and servers are affected by a vulnerability similar to [CVE-2017-0143](https://www.cvedetails.com/cve/CVE-2017-0143/), which lets attackers execute arbitrary code in these systems remotely without any user activity required. So the entire AD is basicly vulnerable to wormable RCE. This is also a zero-day vulnerability, which is not yet knowledged by any other than malicious factors.

Acme has done risk management previously and recognised a vulnerability in their Linux backup server that contains data like database files, customer bills, important documents, shares etc. Vulnerability gives unauthorized access to all the backup data in the server by any authority with an access to the server. Vulnerability has been identified as a risk, but it has not yet been mitigated with a freely available patch, since the personnel responsible for this risk are too burdened by other tasks.

#### Chain of events

Acme has also identified phishing as a potential risk and the company has given its employees training, which helps them identify malicious emails. One of the employees receives a legitimate looking email. He has been expecting a purchase verification from external partner and email address from which the email arrived, belongs to that partner. Email states that the purchase information can be found from PDF file that has been send as an attachment with the email. User is convinced that this email is legitimate and proceeds to download the PDF to his computer. After that he opens the file with a PDF reader. The PDF reader software is old and it has not been updated once after it was downloaded. It contains several vulnerabilities that have been patched on future updates. The PDF file contains malicious code that is executed when user opens the file using vulnerable version of the PDF reader.

The malicious code (exploit) executes in the user's PDF software. Exploit downloads executable from known malicious actor's [CnC](../../../../Data%20Collection/tactics/Command%20and%20Control) server to user's PC. After the download is complete, the executable is executed by the exploit. The executable contains worm that exploits the Windows RCE which was mentioned before. Worm also comes with ransomware component that encrypts all the documents, text files etc. that are not related to the Windows machine functionality, so that the PC will work normally even after the encryption routine is done. After encryption, malware displays ransom demand in the machine's GUI. Worm starts to spread in the user machine's internal network first. Then it tries to move into other internal networks. One by one Windows workstations and servers are infected by the malware. Ransomware component activates after 15 minutes of infestation. Soon hundreds of Windows machines' data is encrypted by the malware.

This malware also targets backup servers by looking for certain known vulnerabilities in the backup servers. One of the vulnerabilities that it tries to target, is the one in the Linux backup server which was mentioned before. Workstations cannot make direct connections to the backup server, but DCs are capable to do so and since they are also affected by the malware, it spreads to the backup server through DC and encrypts all the backup data. Since the backup server data is now also encrypted, organization has no way to get all the data back unless they pay the ransom, which may not even result in data recovery.

#### Risks associated with the hypothesis

Scenario discussed above was a summary of several risks combined. Even though the scenario seems very unlikely and many things will have to go wrong before it can happen, it is still a possibility and that is the point of hypotheses in this context. You can create unlikely chain of events by combining risks together. Doing this may help organizations to find out risks that were not taken into account before. For example, in this hypotheses the attacker obtained initial access by abusing trusted relationship between organization and its partner. Process of risk identification could potentially miss this risk or the zero-day vulnerability, which is also a possibility. Hypotheses are even more beneficial when they are combined with a real threat actor. This process is explained in the next risk assessment phase, which is [risk to threat](../Risk to Threat).

Some of the risks listed in the hypothesis are gathered below:

<ol>
    <li><b>Spear-phishing by abusing trusted relationship</b>: User trusted content of the email message, since it came from partner organization's legitimate email address. The address was compromised by an attacker who could read all the emails in the account and send legitimate looking email with malicious attachment, since he knew that recipient was excepting email like that. Risk management team should pay attention to the fact, that their partner organization's assets may also be compromised.</li> 
    <li><b>Vulnerable PDF reader software</b>: User had an old version of PDF reader software, which contained vulnerability that the exploit abused. This particular user had downloaded this software few years ago and denied its future updates. Organization users may sometimes have downloaded software that poses a threat. This should be acknowledged by risk management team and they should find a way to train the users or establish some sort of restrictive measures for external software.</li> 
    <li><b>Zero-day vulnerability in Windows machines</b>: Windows servers and workstations had a wormable zero-day that enabled RCE in the machines, which resulted in ransomware spread across the company. Since the vulnerability was zero-day, risk management team could not identify it. They can still prepare for this kind of vulnerabilities by pre-emptively creating plans and procedures to mitigate the risk impact as much as possible.</li> 
    <li><b>Vulnerability in the backup server</b>: Backup server had a known vulnerability, which allowed backup data access to anyone with access to the server. Using this vulnerability, the ransomware encrypted backup data in the server. As mentioned before, personnel responsible for updating the server were too busy with other tasks, so they left it at a later date. It should be made sure that risk mitigation tasks are spread across several people, so that the staff has enough time for the fixes. During <a href="../../Risk Monitoring">monitoring</a> phase, personnel responsible for the mitigation actions should also be supervised to make sure that the proper actions are assuredly taken.</li> 
</ol>

## References

<ul>
    <li>https://attack.mitre.org/</li>
</ul>

